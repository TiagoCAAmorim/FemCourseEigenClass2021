/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */

///\cond
#include <iostream>
///\endcond
#include "IntRuleTriangle.h"

IntRuleTriangle::IntRuleTriangle(){
    SetOrder(0);
}

IntRuleTriangle::IntRuleTriangle(int order) {
    SetOrder(order);
}

void IntRuleTriangle::SetOrder(int order) {
    // https://mathsfromnothing.au/triangle-quadrature-rules/?i=1
    fOrder = order;
    switch (order) {
        case 0:
            fPoints.resize(0, 2);
            fWeights.resize(0);
            break;
        case 1:
            fPoints.resize(1, 2);
            fWeights.resize(1);

            fPoints(0,0) = 1./3.;
            fPoints(0,1) = 1./3.;

            fWeights[0] = 1.;
            break;
        case 2:
            fPoints.resize(3, 2);
            fWeights.resize(3);

            fPoints(0,0) = 1./6.; //0.;
            fPoints(1,0) = 1./6.; //1./2.;
            fPoints(2,0) = 2./3.; //1./2.;

            fPoints(0,1) = 2./3.; //1./2.;
            fPoints(1,1) = 1./6.; //0.;
            fPoints(2,1) = 1./6.; //1./2.;

            fWeights[0] = 1./3.;
            fWeights[1] = 1./3.;
            fWeights[2] = 1./3.;
            break;
        case 3:
            fPoints.resize(4, 2);
            fWeights.resize(4);

            fPoints(0,0) = 1./3.;
            fPoints(1,0) = 0.2; //2./15.;
            fPoints(2,0) = 0.2; //2./15.;
            fPoints(3,0) = 0.6; //11./15.;

            fPoints(0,1) = 1./3.;
            fPoints(1,1) = 0.6; //11./15.;
            fPoints(2,1) = 0.2; //2./15.;
            fPoints(3,1) = 0.2; //2./15.;

            fWeights[0] = -27./48.;
            fWeights[1] = 25./48.;
            fWeights[2] = 25./48.;
            fWeights[3] = 25./48.;
            break;
        case 4:
            fPoints.resize(6, 2);
            fWeights.resize(6);

            fWeights[0] = 0.223381589678011;
            fWeights[1] = 0.223381589678011;
            fWeights[2] = 0.223381589678011;
            fWeights[3] = 0.109951743655322;
            fWeights[4] = 0.109951743655322;
            fWeights[5] = 0.109951743655322;

            fPoints(0,0) = 0.445948490915965;
            fPoints(1,0) = 0.445948490915965;
            fPoints(2,0) = 0.108103018168070;
            fPoints(3,0) = 0.091576213509771;
            fPoints(4,0) = 0.091576213509771;
            fPoints(5,0) = 0.816847572980459;

            fPoints(0,1) = 0.108103018168070;
            fPoints(1,1) = 0.445948490915965;
            fPoints(2,1) = 0.445948490915965;
            fPoints(3,1) = 0.816847572980459;
            fPoints(4,1) = 0.091576213509771;
            fPoints(5,1) = 0.091576213509771;
            break;

        case 5:
            fPoints.resize(7, 2);
            fWeights.resize(7);

            fWeights[0] = 0.225;
            fWeights[1] = 0.132394152788506;
            fWeights[2] = 0.132394152788506;
            fWeights[3] = 0.132394152788506;
            fWeights[4] = 0.125939180544827;
            fWeights[5] = 0.125939180544827;
            fWeights[6] = 0.125939180544827;

            fPoints(0,0) = 0.333333333333333;
            fPoints(1,0) = 0.470142064105115;
            fPoints(2,0) = 0.470142064105115;
            fPoints(3,0) = 0.059715871789770;
            fPoints(4,0) = 0.101286507323456;
            fPoints(5,0) = 0.101286507323456;
            fPoints(6,0) = 0.797426985353087;

            fPoints(0,1) = 0.333333333333333;
            fPoints(1,1) = 0.059715871789770;
            fPoints(2,1) = 0.470142064105115;
            fPoints(3,1) = 0.470142064105115;
            fPoints(4,1) = 0.797426985353087;
            fPoints(5,1) = 0.101286507323456;
            fPoints(6,1) = 0.101286507323456;
            break;

        case 6:
            fPoints.resize(12, 2);
            fWeights.resize(12);

            fWeights[0]  = 0.050844906370207;
            fWeights[1]  = 0.050844906370207;
            fWeights[2]  = 0.050844906370207;
            fWeights[3]  = 0.082851075618374;
            fWeights[4]  = 0.082851075618374;
            fWeights[5]  = 0.082851075618374;
            fWeights[6]  = 0.082851075618374;
            fWeights[7]  = 0.082851075618374;
            fWeights[8]  = 0.082851075618374;
            fWeights[9]  = 0.116786275726379;
            fWeights[10] = 0.116786275726379;
            fWeights[11] = 0.116786275726379;

            fPoints(0,0)  = 0.063089014491502;
            fPoints(1,0)  = 0.063089014491502;
            fPoints(2,0)  = 0.873821971016996;
            fPoints(3,0)  = 0.053145049844817;
            fPoints(4,0)  = 0.310352451033784;
            fPoints(5,0)  = 0.636502499121399;
            fPoints(6,0)  = 0.310352451033784;
            fPoints(7,0)  = 0.053145049844817;
            fPoints(8,0)  = 0.636502499121399;
            fPoints(9,0)  = 0.249286745170910;
            fPoints(10,0) = 0.249286745170910;
            fPoints(11,0) = 0.501426509658179;

            fPoints(0,1)  = 0.873821971016996;
            fPoints(1,1)  = 0.063089014491502;
            fPoints(2,1)  = 0.063089014491502;
            fPoints(3,1)  = 0.636502499121399;
            fPoints(4,1)  = 0.053145049844817;
            fPoints(5,1)  = 0.310352451033784;
            fPoints(6,1)  = 0.636502499121399;
            fPoints(7,1)  = 0.310352451033784;
            fPoints(8,1)  = 0.053145049844817;
            fPoints(9,1)  = 0.501426509658179;
            fPoints(10,1) = 0.249286745170910;
            fPoints(11,1) = 0.249286745170910;
            break;

        case 7:
            fPoints.resize(13, 2);
            fWeights.resize(13);

            fWeights[0]  = -0.149570044467682;
            fWeights[1]  = 0.053347235608838;
            fWeights[2]  = 0.053347235608838;
            fWeights[3]  = 0.053347235608838;
            fWeights[4]  = 0.077113760890257;
            fWeights[5]  = 0.077113760890257;
            fWeights[6]  = 0.077113760890257;
            fWeights[7]  = 0.077113760890257;
            fWeights[8]  = 0.077113760890257;
            fWeights[9]  = 0.077113760890257;
            fWeights[10] = 0.175615257433208;
            fWeights[11] = 0.175615257433208;
            fWeights[12] = 0.175615257433208;

            fPoints(0,0)  = 0.333333333333333;
            fPoints(1,0)  = 0.065130102902216;
            fPoints(2,0)  = 0.065130102902216;
            fPoints(3,0)  = 0.869739794195568;
            fPoints(4,0)  = 0.048690315425316;
            fPoints(5,0)  = 0.312865496004874;
            fPoints(6,0)  = 0.638444188569810;
            fPoints(7,0)  = 0.312865496004874;
            fPoints(8,0)  = 0.048690315425316;
            fPoints(9,0)  = 0.638444188569810;
            fPoints(10,0) = 0.260345966079040;
            fPoints(11,0) = 0.260345966079040;
            fPoints(12,0) = 0.479308067841920;

            fPoints(0,1)  = 0.333333333333333;
            fPoints(1,1)  = 0.869739794195568;
            fPoints(2,1)  = 0.065130102902216;
            fPoints(3,1)  = 0.065130102902216;
            fPoints(4,1)  = 0.638444188569810;
            fPoints(5,1)  = 0.048690315425316;
            fPoints(6,1)  = 0.312865496004874;
            fPoints(7,1)  = 0.638444188569810;
            fPoints(8,1)  = 0.312865496004874;
            fPoints(9,1)  = 0.048690315425316;
            fPoints(10,1) = 0.479308067841920;
            fPoints(11,1) = 0.260345966079040;
            fPoints(12,1) = 0.260345966079040;
            break;

        case 8:
            fPoints.resize(16, 2);
            fWeights.resize(16);

            fWeights[0]  = 0.144315607677787;
            fWeights[1]  = 0.095091634267285;
            fWeights[2]  = 0.095091634267285;
            fWeights[3]  = 0.095091634267285;
            fWeights[4]  = 0.103217370534718;
            fWeights[5]  = 0.103217370534718;
            fWeights[6]  = 0.103217370534718;
            fWeights[7]  = 0.027230314174435;
            fWeights[8]  = 0.027230314174435;
            fWeights[9]  = 0.027230314174435;
            fWeights[10] = 0.027230314174435;
            fWeights[11] = 0.027230314174435;
            fWeights[12] = 0.027230314174435;
            fWeights[13] = 0.032458497623198;
            fWeights[14] = 0.032458497623198;
            fWeights[15] = 0.032458497623198;

            fPoints(0,0)  = 0.333333333333333;
            fPoints(1,0)  = 0.459292588292723;
            fPoints(2,0)  = 0.459292588292723;
            fPoints(3,0)  = 0.081414823414554;
            fPoints(4,0)  = 0.170569307751760;
            fPoints(5,0)  = 0.170569307751760;
            fPoints(6,0)  = 0.658861384496480;
            fPoints(7,0)  = 0.008394777409958;
            fPoints(8,0)  = 0.263112829634638;
            fPoints(9,0)  = 0.728492392955404;
            fPoints(10,0) = 0.263112829634638;
            fPoints(11,0) = 0.008394777409958;
            fPoints(12,0) = 0.728492392955404;
            fPoints(13,0) = 0.050547228317031;
            fPoints(14,0) = 0.050547228317031;
            fPoints(15,0) = 0.898905543365938;

            fPoints(0,1)  = 0.333333333333333;
            fPoints(1,1)  = 0.081414823414554;
            fPoints(2,1)  = 0.459292588292723;
            fPoints(3,1)  = 0.459292588292723;
            fPoints(4,1)  = 0.658861384496480;
            fPoints(5,1)  = 0.170569307751760;
            fPoints(6,1)  = 0.170569307751760;
            fPoints(7,1)  = 0.728492392955404;
            fPoints(8,1)  = 0.008394777409958;
            fPoints(9,1)  = 0.263112829634638;
            fPoints(10,1) = 0.728492392955404;
            fPoints(11,1) = 0.263112829634638;
            fPoints(12,1) = 0.008394777409958;
            fPoints(13,1) = 0.898905543365938;
            fPoints(14,1) = 0.050547228317031;
            fPoints(15,1) = 0.050547228317031;
            break;

        case 9:
            fPoints.resize(19, 2);
            fWeights.resize(19);

            fWeights[0]  = 0.097135796282799;
            fWeights[1]  = 0.031334700227139;
            fWeights[2]  = 0.031334700227139;
            fWeights[3]  = 0.031334700227139;
            fWeights[4]  = 0.077827541004774;
            fWeights[5]  = 0.077827541004774;
            fWeights[6]  = 0.077827541004774;
            fWeights[7]  = 0.079647738927210;
            fWeights[8]  = 0.079647738927210;
            fWeights[9]  = 0.079647738927210;
            fWeights[10] = 0.043283539377289;
            fWeights[11] = 0.043283539377289;
            fWeights[12] = 0.043283539377289;
            fWeights[13] = 0.043283539377289;
            fWeights[14] = 0.043283539377289;
            fWeights[15] = 0.043283539377289;
            fWeights[16] = 0.025577675658698;
            fWeights[17] = 0.025577675658698;
            fWeights[18] = 0.025577675658698;

            fPoints(0,0)  = 0.333333333333333;
            fPoints(1,0)  = 0.489682519198738;
            fPoints(2,0)  = 0.489682519198738;
            fPoints(3,0)  = 0.020634961602525;
            fPoints(4,0)  = 0.437089591492937;
            fPoints(5,0)  = 0.437089591492937;
            fPoints(6,0)  = 0.125820817014127;
            fPoints(7,0)  = 0.188203535619033;
            fPoints(8,0)  = 0.188203535619033;
            fPoints(9,0)  = 0.623592928761935;
            fPoints(10,0) = 0.036838412054736;
            fPoints(11,0) = 0.221962989160766;
            fPoints(12,0) = 0.741198598784498;
            fPoints(13,0) = 0.221962989160766;
            fPoints(14,0) = 0.036838412054736;
            fPoints(15,0) = 0.741198598784498;
            fPoints(16,0) = 0.044729513394453;
            fPoints(17,0) = 0.044729513394453;
            fPoints(18,0) = 0.910540973211095;

            fPoints(0,1)  = 0.333333333333333;
            fPoints(1,1)  = 0.020634961602525;
            fPoints(2,1)  = 0.489682519198738;
            fPoints(3,1)  = 0.489682519198738;
            fPoints(4,1)  = 0.125820817014127;
            fPoints(5,1)  = 0.437089591492937;
            fPoints(6,1)  = 0.437089591492937;
            fPoints(7,1)  = 0.623592928761935;
            fPoints(8,1)  = 0.188203535619033;
            fPoints(9,1)  = 0.188203535619033;
            fPoints(10,1) = 0.741198598784498;
            fPoints(11,1) = 0.036838412054736;
            fPoints(12,1) = 0.221962989160766;
            fPoints(13,1) = 0.741198598784498;
            fPoints(14,1) = 0.221962989160766;
            fPoints(15,1) = 0.036838412054736;
            fPoints(16,1) = 0.910540973211095;
            fPoints(17,1) = 0.044729513394453;
            fPoints(18,1) = 0.044729513394453;
            break;

        case 10:
            fPoints.resize(25, 2);
            fWeights.resize(25);

            fWeights[0]  = 0.090817990382754;
            fWeights[1]  = 0.036725957756467;
            fWeights[2]  = 0.036725957756467;
            fWeights[3]  = 0.036725957756467;
            fWeights[4]  = 0.072757916845420;
            fWeights[5]  = 0.072757916845420;
            fWeights[6]  = 0.072757916845420;
            fWeights[7]  = 0.072757916845420;
            fWeights[8]  = 0.072757916845420;
            fWeights[9]  = 0.072757916845420;
            fWeights[10] = 0.028327242531057;
            fWeights[11] = 0.028327242531057;
            fWeights[12] = 0.028327242531057;
            fWeights[13] = 0.028327242531057;
            fWeights[14] = 0.028327242531057;
            fWeights[15] = 0.028327242531057;
            fWeights[16] = 0.009421666963733;
            fWeights[17] = 0.009421666963733;
            fWeights[18] = 0.009421666963733;
            fWeights[19] = 0.009421666963733;
            fWeights[20] = 0.009421666963733;
            fWeights[21] = 0.009421666963733;
            fWeights[22] = 0.045321059435528;
            fWeights[23] = 0.045321059435528;
            fWeights[24] = 0.045321059435528;

            fPoints(0,0)  = 0.333333333333333;
            fPoints(1,0)  = 0.485577633383657;
            fPoints(2,0)  = 0.485577633383657;
            fPoints(3,0)  = 0.028844733232685;
            fPoints(4,0)  = 0.141707219414880;
            fPoints(5,0)  = 0.307939838764121;
            fPoints(6,0)  = 0.550352941820999;
            fPoints(7,0)  = 0.307939838764121;
            fPoints(8,0)  = 0.141707219414880;
            fPoints(9,0)  = 0.550352941820999;
            fPoints(10,0) = 0.025003534762686;
            fPoints(11,0) = 0.246672560639903;
            fPoints(12,0) = 0.728323904597411;
            fPoints(13,0) = 0.246672560639903;
            fPoints(14,0) = 0.025003534762686;
            fPoints(15,0) = 0.728323904597411;
            fPoints(16,0) = 0.009540815400299;
            fPoints(17,0) = 0.066803251012200;
            fPoints(18,0) = 0.923655933587500;
            fPoints(19,0) = 0.066803251012200;
            fPoints(20,0) = 0.009540815400299;
            fPoints(21,0) = 0.923655933587500;
            fPoints(22,0) = 0.109481575485037;
            fPoints(23,0) = 0.109481575485037;
            fPoints(24,0) = 0.781036849029926;

            fPoints(0,1)  = 0.333333333333333;
            fPoints(1,1)  = 0.028844733232685;
            fPoints(2,1)  = 0.485577633383657;
            fPoints(3,1)  = 0.485577633383657;
            fPoints(4,1)  = 0.550352941820999;
            fPoints(5,1)  = 0.141707219414880;
            fPoints(6,1)  = 0.307939838764121;
            fPoints(7,1)  = 0.550352941820999;
            fPoints(8,1)  = 0.307939838764121;
            fPoints(9,1)  = 0.141707219414880;
            fPoints(10,1) = 0.728323904597411;
            fPoints(11,1) = 0.025003534762686;
            fPoints(12,1) = 0.246672560639903;
            fPoints(13,1) = 0.728323904597411;
            fPoints(14,1) = 0.246672560639903;
            fPoints(15,1) = 0.025003534762686;
            fPoints(16,1) = 0.923655933587500;
            fPoints(17,1) = 0.009540815400299;
            fPoints(18,1) = 0.066803251012200;
            fPoints(19,1) = 0.923655933587500;
            fPoints(20,1) = 0.066803251012200;
            fPoints(21,1) = 0.009540815400299;
            fPoints(22,1) = 0.781036849029926;
            fPoints(23,1) = 0.109481575485037;
            fPoints(24,1) = 0.109481575485037;
            break;

        default:
            DebugStop("Maximum order implemented for a triangular element: 10.\n");
    }

    for (int i=0; i<fWeights.size(); i++){
        fWeights[i] = fWeights[i]/2.;
    }

}
